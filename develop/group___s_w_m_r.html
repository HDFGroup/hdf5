<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HDF5: Single Writer Multiple Readers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="hdf5doxy.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="hdf5doxy.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="hdf5_navtree_hacks.js"></script>
<div style="background:#FFDDDD;font-size:120%;text-align:center;margin:0;padding:5px">Please, help us to better serve our user community by answering the following short survey:  <a href="https://www.hdfgroup.org/website-survey/">https://www.hdfgroup.org/website-survey/</a></div>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="HDFG-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">HDF5<span id="projectnumber">&#160;1.15.0.a8dcba2</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="_getting_started.html"><span>Getting&#160;started</span></a></li>
      <li><a href="_u_g.html"><span>User&#160;Guide</span></a></li>
      <li><a href="_r_m.html"><span>Reference&#160;Manual</span></a></li>
      <li><a href="_cookbook.html"><span>Cookbook</span></a></li>
      <li><a href="_t_n.html"><span>Technical&#160;Notes</span></a></li>
      <li><a href="_r_f_c.html"><span>RFCs</span></a></li>
      <li><a href="_s_p_e_c.html"><span>Specifications</span></a></li>
      <li><a href="_g_l_s.html"><span>Glossary</span></a></li>
      <li><a href="_about.html"><span>About</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group___s_w_m_r.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Single Writer Multiple Readers<div class="ingroups"><a class="el" href="group___h5_f.html">Files (H5F)</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa80bd62f19993e414e383db7d1623e5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_h5public_8h.html#a3b079ecf932a5c599499cf7e298af160">herr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_w_m_r.html#gaa80bd62f19993e414e383db7d1623e5f">H5Fget_metadata_read_retry_info</a> (<a class="el" href="_h5_ipublic_8h.html#a0045db7ff9c22ad35db6ae91662e1943">hid_t</a> file_id, <a class="el" href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a> *info)</td></tr>
<tr class="memdesc:gaa80bd62f19993e414e383db7d1623e5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the collection of read retries for metadata entries with checksum.  <br /></td></tr>
<tr class="separator:gaa80bd62f19993e414e383db7d1623e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga159be34fbe7e4a959589310ef0196dfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_h5public_8h.html#a3b079ecf932a5c599499cf7e298af160">herr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_w_m_r.html#ga159be34fbe7e4a959589310ef0196dfe">H5Fstart_swmr_write</a> (<a class="el" href="_h5_ipublic_8h.html#a0045db7ff9c22ad35db6ae91662e1943">hid_t</a> file_id)</td></tr>
<tr class="memdesc:ga159be34fbe7e4a959589310ef0196dfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves free-space section information for a file.  <br /></td></tr>
<tr class="separator:ga159be34fbe7e4a959589310ef0196dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa80bd62f19993e414e383db7d1623e5f" name="gaa80bd62f19993e414e383db7d1623e5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa80bd62f19993e414e383db7d1623e5f">&#9670;&#160;</a></span>H5Fget_metadata_read_retry_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_h5public_8h.html#a3b079ecf932a5c599499cf7e298af160">herr_t</a> H5Fget_metadata_read_retry_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_h5_ipublic_8h.html#a0045db7ff9c22ad35db6ae91662e1943">hid_t</a>&#160;</td>
          <td class="paramname"><em>file_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the collection of read retries for metadata entries with checksum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file_id</td><td>File identifier </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td>Struct containing the collection of read retries for metadata entries with checksum </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a non-negative value if successful; otherwise, returns a negative value.<br  />
</dd></dl>
<p><b>Failure Modes:</b> </p><ul>
<li>When the input identifier is not a file identifier. </li>
<li>When the pointer to the output structure is NULL. </li>
<li>When the memory allocation for <code>retries</code> failed.</li>
</ul>
<p><a class="el" href="group___s_w_m_r.html#gaa80bd62f19993e414e383db7d1623e5f" title="Retrieves the collection of read retries for metadata entries with checksum.">H5Fget_metadata_read_retry_info()</a> retrieves information regarding the number of read retries for metadata entries with checksum for the file <code>file_id</code>. This information is reported in the <a class="el" href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a> struct defined in <a class="el" href="_h5_fpublic_8h.html">H5Fpublic.h</a> as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#define H5F_NUM_METADATA_READ_RETRY_TYPES 21</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a> {</div>
<div class="line">    <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="struct_h5_f__retry__info__t.html#aa86f48adcf8ee5bbe9d05ae595130544">nbins</a>;</div>
<div class="line">    uint32_t *<a class="code hl_variable" href="struct_h5_f__retry__info__t.html#a9ed64b2becff4cade9713b0cd9f3827e">retries</a>[<a class="code hl_define" href="_h5_fpublic_8h.html#a3a67d0d121762e7c44c4ef3f40a49611">H5F_NUM_METADATA_READ_RETRY_TYPES</a>];</div>
<div class="line">} <a class="code hl_struct" href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a>;</div>
<div class="ttc" id="a_h5_fpublic_8h_html_a3a67d0d121762e7c44c4ef3f40a49611"><div class="ttname"><a href="_h5_fpublic_8h.html#a3a67d0d121762e7c44c4ef3f40a49611">H5F_NUM_METADATA_READ_RETRY_TYPES</a></div><div class="ttdeci">#define H5F_NUM_METADATA_READ_RETRY_TYPES</div><div class="ttdef"><b>Definition</b> H5Fpublic.h:228</div></div>
<div class="ttc" id="astruct_h5_f__retry__info__t_html"><div class="ttname"><a href="struct_h5_f__retry__info__t.html">H5F_retry_info_t</a></div><div class="ttdef"><b>Definition</b> H5Fpublic.h:234</div></div>
<div class="ttc" id="astruct_h5_f__retry__info__t_html_a9ed64b2becff4cade9713b0cd9f3827e"><div class="ttname"><a href="struct_h5_f__retry__info__t.html#a9ed64b2becff4cade9713b0cd9f3827e">H5F_retry_info_t::retries</a></div><div class="ttdeci">uint32_t * retries[21]</div><div class="ttdef"><b>Definition</b> H5Fpublic.h:236</div></div>
<div class="ttc" id="astruct_h5_f__retry__info__t_html_aa86f48adcf8ee5bbe9d05ae595130544"><div class="ttname"><a href="struct_h5_f__retry__info__t.html#aa86f48adcf8ee5bbe9d05ae595130544">H5F_retry_info_t::nbins</a></div><div class="ttdeci">unsigned nbins</div><div class="ttdef"><b>Definition</b> H5Fpublic.h:235</div></div>
</div><!-- fragment --><p> <code>nbins</code> is the number of bins for each <code>retries</code>[i] of metadata entry <code>i</code>. It is calculated based on the current number of read attempts used in the library and logarithmic base 10.</p>
<p>If read retries are incurred for a metadata entry <code>i</code>, the library will allocate memory for <code>retries[i] (nbins * sizeof(uint32_t)</code> and store the collection of retries there. If there are no retries for a metadata entry <code>i</code>, <code>retries[i]</code> will be NULL. After a call to this routine, users should free each <code>retries[i]</code> that is non-NULL, otherwise resource leak will occur.</p>
<p>For the library default read attempts of 100 for SWMR access, nbins will be 2 as depicted below: </p><ul>
<li><code>retries[i][0]</code> is the number of 1 to 9 read retries. </li>
<li><code>retries[i][1]</code> is the number of 10 to 99 read retries. For the library default read attempts of 1 for non-SWMR access, <code>nbins</code> will be 0 and each <code>retries[i]</code> will be NULL.</li>
</ul>
<p>The following table lists the 21 metadata entries of <code>retries[]</code>: </p><table class="doxtable">
<tr>
<th>Index for <code>retries[]</code> </th><th>Metadata entries<sup>*</sup>  </th></tr>
<tr>
<td>0</td><td>Object header (version 2) </td></tr>
<tr>
<td>1</td><td>Object header chunk (version 2) </td></tr>
<tr>
<td>2</td><td>B-tree header (version 2) </td></tr>
<tr>
<td>3</td><td>B-tree internal node (version 2) </td></tr>
<tr>
<td>4</td><td>B-tree leaf node (version 2) </td></tr>
<tr>
<td>5</td><td>Fractal heap header </td></tr>
<tr>
<td>6</td><td>Fractal heap direct block (optional checksum) </td></tr>
<tr>
<td>7</td><td>Fractal heap indirect block </td></tr>
<tr>
<td>8</td><td>Free-space header </td></tr>
<tr>
<td>9</td><td>Free-space sections </td></tr>
<tr>
<td>10</td><td>Shared object header message table </td></tr>
<tr>
<td>11</td><td>Shared message record list </td></tr>
<tr>
<td>12</td><td>Extensive array header </td></tr>
<tr>
<td>13</td><td>Extensive array index block </td></tr>
<tr>
<td>14</td><td>Extensive array super block </td></tr>
<tr>
<td>15</td><td>Extensive array data block </td></tr>
<tr>
<td>16</td><td>Extensive array data block page </td></tr>
<tr>
<td>17</td><td>Fixed array super block </td></tr>
<tr>
<td>18</td><td>Fixed array data block </td></tr>
<tr>
<td>19</td><td>Fixed array data block page </td></tr>
<tr>
<td>20</td><td>File's superblock (version 2) </td></tr>
<tr>
<td colspan="2"><sup>*</sup> All entries are of version 0 (zero) unless indicated otherwise. </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>On a system that is not atomic, the library might possibly read inconsistent metadata with checksum when performing single-writer/multiple-reader (SWMR) operations for an HDF5 file. Upon encountering such situations, the library will try reading the metadata again for a set number of times to attempt to obtain consistent data. The maximum number of read attempts used by the library will be either the value set via <a class="el" href="group___f_a_p_l.html#gab827cef16ec569c87cec94a8b3f350c5" title="Sets the number of read attempts in a file access property list.">H5Pset_metadata_read_attempts()</a> or the library default value when a value is not set.<br  />
 When the current number of metadata read attempts used in the library is unable to remedy the reading of inconsistent metadata on a system, the user can assess the information obtained via this routine to derive a different maximum value. The information can also be helpful for debugging purposes to identify potential issues with metadata flush dependencies and SWMR implementation in general.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.10.0 </dd></dl>

</div>
</div>
<a id="ga159be34fbe7e4a959589310ef0196dfe" name="ga159be34fbe7e4a959589310ef0196dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga159be34fbe7e4a959589310ef0196dfe">&#9670;&#160;</a></span>H5Fstart_swmr_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_h5public_8h.html#a3b079ecf932a5c599499cf7e298af160">herr_t</a> H5Fstart_swmr_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_h5_ipublic_8h.html#a0045db7ff9c22ad35db6ae91662e1943">hid_t</a>&#160;</td>
          <td class="paramname"><em>file_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves free-space section information for a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file_id</td><td>File identifier</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a non-negative value if successful; otherwise, returns a negative value.</dd></dl>
<p><a class="el" href="group___s_w_m_r.html#ga159be34fbe7e4a959589310ef0196dfe" title="Retrieves free-space section information for a file.">H5Fstart_swmr_write()</a> will activate SWMR writing mode for a file associated with <code>file_id</code>. This routine will prepare and ensure the file is safe for SWMR writing as follows: </p><ul>
<li>Check that the file is opened with write access (<a class="el" href="_h5_fpublic_8h.html#a402673dec5c537b27a49a9a8bd6140b4">H5F_ACC_RDWR</a>). </li>
<li>Check that the file is opened with the latest library format to ensure data structures with check-summed metadata are used. </li>
<li>Check that the file is not already marked in SWMR writing mode. </li>
<li>Enable reading retries for check-summed metadata to remedy possible checksum failures from reading inconsistent metadata on a system that is not atomic. </li>
<li>Turn off usage of the library's accumulator to avoid possible ordering problem on a system that is not atomic. </li>
<li>Perform a flush of the file's data buffers and metadata to set a consistent state for starting SWMR write operations.</li>
</ul>
<p>Library objects are groups, datasets, and committed datatypes. For the current implementation, groups and datasets can remain open when activating SWMR writing mode, but not committed datatypes. Attributes attached to objects cannot remain open either.</p>
<dl class="section since"><dt>Since</dt><dd>1.10.0 </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
