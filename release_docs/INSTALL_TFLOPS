FOR THE INTEL TFLOPS MACHINE:

Below are the step-by-step procedures for building, testing, and
installing the parallel and sequential versions of the HDF5 library.

-----------------
Software locations
------------------
The zlib compression library is installed in /usr/community/hdf5/ZLIB.
The latest version is zlib v1.1.4.

The mpich library, including mpi-io support, is now supported by the 
TFLOPS system staff.  Check Sasn100:/usr/local/FAQ/R4.4.0_Release_Notes
for details.  A modified version of mpicc is created to simply the
command. It is installed as /usr/community/hdf5/tflop-mpich/bin/mpicc.

---------------
gmake recommended
---------------
Both Sasn100 and Janus have multiple versions of the make command.
We recommand the use of the Gnu gmake which has some features
(e.g., -j and --srcdir support) that makes (sic) life easier.

---------------
Parallel HDF5:
---------------

The setup process for building the parallel version of the HDF5 library for the
ASCI Red machine is very similar to the sequential version.  Since TFLOPS
does not support MPIO, we have prepared a shell-script file that configures
with the appropriate MPI library.

Assuming you have already unpacked the HDF5 tar-file into the 
directory <hdf5>, follow the steps below:
FROM SASN100,

1) cd <hdf5>

2) CC=/usr/community/hdf5/tflop-mpich/bin/mpicc \
      ./configure --host=tflops --with-zlib=/usr/community/hdf5/ZLIB

   Alternately, you may specify the host explicitly:

   CC=/usr/community/hdf5/tflop-mpich/bin/mpicc \
      ./configure --host=i386-intel-osf1 --with-zlib=/usr/community/hdf5/ZLIB

   Skip the "--with-zlib=..." option if you do not wish to include the zlib
   compression feature.  Without the zlib compression feature, the library
   will not be able to access zlib compressed datasets.

   You may safely ignore the WARNING message,
    =========
    configure: WARNING: If you wanted to set the --build type, don't use --host.
	If a cross compiler is detected then cross compile mode will be used.
    =========
   You may add the option "--build=i386-intel-osf1" to get rid of the WARNING.

   (The previous bugs in src/Makefile and test/Makefile have been resolved.
    You don't need to edit them any more.)

3) gmake H5detect


FROM JANUS, 

4) cd <hdf5>

5) gmake H5Tinit.c


FROM SASN100,

6) gmake


When everything is finished compiling and linking,
FROM JANUS, 

7) gmake check 
   (We have not encountered the following problem for a year.)
   Sometimes the "gmake check" fails in the sub-directories of test
   or tools with a message as "print not found".  This is due to the
   "gmake" of Janus thinking some binary code needs to be recompiled.
   The easiest way to fix it is
   FROM SASN100
   cd <hdf5>/test	# or cd <hdf5>/tools
   gmake clean; gmake   # re-make all binary


Once satisfied with the parallel test results, as long as you 
have the correct permission,
FROM SASN100,

8) gmake install


---------------
Sequential HDF5:
---------------
(**NOTE** We have stopped testing sequential HDF5 for the Tflops machine
since it has little practical value to build sequential applications for
the Tflops machine.  The instruction below are kept more for historical
purpose.)

The setup process for building the sequential HDF5 library for the
ASCI Red machine is done by a coordination of events from sasn100 and
janus.  Though janus can do compiling, it is better to build it
from sasn100 which has more complete building tools and runs faster.
It is also anti-social to tie up janus with compiling.  The HDF5 building
requires the use of janus because one of steps is to execute a program
to find out the run-time characteristics of the TFLOPS machine.

Assuming you have already unpacked the HDF5 tar-file into the 
directory <hdf5>, follow the steps below:

FROM SASN100,

1) cd <hdf5>

2) ./configure --host=tflops --with-zlib=/usr/community/hdf5/ZLIB

   Alternately, you may specify the host explicitly:

   ./configure --host=i386-intel-osf1 --with-zlib=/usr/community/hdf5/ZLIB

   Skip the "--with-zlib=..." option if you do not wish to include the zlib
   compression feature.  Without the zlib compression feature, the library
   will not be able to access zlib compressed datasets.

   You may safely ignore the WARNING message,
    =========
    configure: WARNING: If you wanted to set the --build type, don't use --host.
	If a cross compiler is detected then cross compile mode will be used.
    =========
   You may add the option "--build=i386-intel-osf1" to get rid of the WARNING.

   (The previous bugs in src/Makefile and test/Makefile have been resolved.
    You don't need to edit them any more.)

3) gmake H5detect


FROM JANUS, 

4) cd <hdf5>

5) gmake H5Tinit.c


FROM SASN100,

6) gmake


When everything is finished compiling and linking,
you can run the tests by
FROM JANUS, 

7) gmake check 
     Sometimes the "gmake check" fails in the sub-directories of test
     or tools with a message as "print not found".  This is due to the
     "gmake" of Janus thinking some binary code needs to be recompiled.
     The easiest way to fix it is
     FROM SASN100
     cd <hdf5>/test	# or cd <hdf5>/tools
     gmake clean; gmake   # re-make all binary


Once satisfied with the test results, you can install
the software by
FROM SASN100,

8) gmake install


